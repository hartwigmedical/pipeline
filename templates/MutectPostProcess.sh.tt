#!/usr/bin/env bash
# -*- TT -*-

[% INCLUDE ErrorHandling.tt %]
[% INCLUDE Logging.tt job_name="MutectPostProcess" main_step=joint_name log_name="mutect.log" %]

cd "[% dirs.mutect.tmp %]"

assert_not_empty "[% input_vcf %]"

java -Xmx[% opt.MUTECT_MEM %]G \
    -jar [% opt.SNPEFF_PATH %]/SnpSift.jar \
    filter "(na FILTER) | (FILTER = 'PASS')" \
    "[% input_vcf %]" \
    > "[% output_vcf %]"

assert_not_empty "[% output_vcf %]"
success
